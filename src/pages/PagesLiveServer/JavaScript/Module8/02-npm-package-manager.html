<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Пакетний менеджер npm</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <header class="header">
      <a href="../../../../indexLS.html" class="green">Home</a>
    </header>
    <main class="main">
      <h1>Пакетний менеджер npm</h1>
      <section class="section">
        <p>
          Щоб використовувати все різноманіття інструментів (або пакетів)
          Node.js, нам необхідна можливість встановлювати і керувати ними. Для
          цього створений <b>NPM</b> (node package manager) - пакетний менеджер
          Node.js. Він встановлює потрібні пакети і забезпечує зручний інтерфейс
          для роботи з ними.
        </p>
        <p>NPM складається з трьох основних компонентів:</p>
        <ul class="section-list">
          <li>
            <b>Сайт npmjs.com</b> - використовується для пошуку та ознайомлення
            з документацією пакетів.
          </li>
          <li>
            <b>Інтерфейс командного рядка (CLI)</b> - запускається з терміналу і
            надає набір команд для роботи з реєстром і пакетами. Дозволяє
            створювати скрипти для запуску в терміналі.
          </li>
          <li>
            <b>Реєстр пакетів (registry)</b> - велика загальнодоступна база
            даних інструментів розробки (пакетів).
          </li>
        </ul>
        <p>
          <b>Пакет (package)</b> - невелика JavaScript бібліотека, що вирішує
          специфічне завдання. Пакети пишуть самі розробники і діляться зі
          спільнотою. Такий підхід спрощує життя, тому що не потрібно винаходити
          колесо, всі колеса вже давно лежать на полицях реєстру і готові до
          використання.
        </p>
        <p class="note">
          ЦІКАВО: Пакети абстрагують реалізацію функціоналу, надаючи розробнику
          зручний інтерфейс. Це робить код чистішим, читабельнішим і дозволяє
          простіше його підтримувати.
        </p>
        <h3>Команди NPM</h3>
        <p>
          Відразу перелічимо основні команди і будемо послідовно використовувати
          і розглядати в деталях.
        </p>
        <ul class="section-list">
          <li>
            npm init - ініціалізує npm в проекті і створює файл package.json
          </li>
          <li>
            npm install - встановлює всі залежності, перелічені в package.json
          </li>
          <li>
            npm list --depth=0 - виведе в терміналі список локально встановлених
            пакетів з номерами їх версій, без залежностей
          </li>
          <li>
            npm install [package-name] - встановить пакет локально у папку
            node_modules
          </li>
          <li>
            npm uninstall [package-name] - видалить пакет, встановлений локально
            і оновить package.json
          </li>
          <li>
            npm start і npm test - запустить скрипт start або test, розташований
            в package.json
          </li>
          <li>
            npm run [custom-script] - запустить кастомний скрипт, розташований в
            package.json
          </li>
          <li>
            npm outdated - використовується для пошуку оновлень, виявить сумісні
            версії програмно і виведе список доступних оновлень
          </li>
          <li>
            npm update - оновить всі пакети до максимально дозволеної версії
          </li>
        </ul>
        <a href="https://docs.npmjs.com/">Документація NPM</a>
        <h3>Ініціалізація проекту</h3>
        <p>
          Кожен проект починається зі створення файлу package.json - він
          відстежує залежності, містить службову інформацію, дозволяє писати
          npm-скрипти і слугує інструкцією під час створення нового проекту на
          основі вже готових налаштувань. Файл package.json можна створити
          npm-командою init, що ініціалізує проект в цій папці.
        </p>
        <p class="code">npm init</p>
        <p>
          Вам буде запропоновано ввести назву проекту, версію, опис тощо. Можна
          просто натискати Enter доти, доки не буде створений package.json і
          розміщений в папці проекту. Щоб не натискати Enter, пропускаючи
          порожні поля, використовується команда init з прапорцем --yes.
          Прапорець - додаткове налаштування для команди.
        </p>
        <p class="code">npm init --yes</p>
        <p class="note">
          ЦІКАВО: У кожного прапорця є псевдонім - його скорочений запис.
          Псевдонім прапорця --yes - -y, тому команди npm init --yes і npm init
          -y роблять одне і те ж.
        </p>
        <p>
          Буде створено package.json зі значеннями за замовчуванням. Щоб
          встановити ці значення, виконайте в терміналі послідовно наступні
          команди, підставивши своє ім'я та пошту.
        </p>
        <pre class="code">
  npm config set init.author.name "YOUR_NAME"
  npm config set init.author.email "YOUR_EMAIL"
</pre
        >
        <img
          src="./img/b2eda3a3-b687-40e8-bb02-dc8bcf69ddb3image.png"
          alt=""
          width="520"
        />
        <p>
          Файл package.json можна редагувати вручну або виконати npm init ще
          раз. Якщо відкрити package.json в редакторі, він буде виглядати
          приблизно так. Це всього лише метадані про проект.
        </p>
        <h4>package.json</h4>
        <pre class="code">
{
  "name": "node-tut",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "test": "echo \\"Error: no test specified\\" && exit 1"
  },
  "author": "Alexander Repeta &lt;mycoolemail@mail.com&gt;",
  "license": "ISC",
  "keywords": [],
  "description": ""
}
</pre
        >
        <h3>npm-скрипти</h3>
        <p>
          Скрипти дозволяють запускати для виконання встановлені пакети.
          Використовуючи npm-скрипти, можна створювати цілі системи збирання
          проекту. Автоматизуємо запуск index.js. Для цього у файлі package.json
          в полі scripts додамо скрипт запуску start.
        </p>
        <h4>package.json</h4>
        <pre class="code">
{
  "scripts": {
    "start": "node index.js"
  }
}
</pre
        >
        <p>Тепер ми можемо запустити його в терміналі командою npm start.</p>
        <img
          src="./img/4c3faf56-1c5d-438e-a5fb-d77b86acaed2image.png"
          alt=""
          width="520"
        />
        <p class="note">
          УВАГА: Якщо створити скрипт з будь-яким іншим ім'ям, крім start або
          test, він буде запускатися як npm run ім'я-скрипта - не забудьте run.
          Ознайомтесь з документацією - How npm handles the "scripts" field.
        </p>
        <h3>Встановлення пакетів</h3>
        <p>
          Одна з можливостей, які надає npm - встановлення пакетів, які
          витягуються з реєстру і розпаковуються в папку node_modules в корені
          проекту. Після створення файлу package.json, можна додати залежності в
          проект.
        </p>
        <p>
          Залежністю називають npm-пакет, який використовується у розробці. Це
          різноманітні утиліти і бібліотеки. Встановимо бібліотеку
          <a href="https://www.npmjs.com/package/validator">validator.js</a> для
          валідації рядків, наприклад, введення користувача в поля форми/
        </p>
        <p class="code">
          УВАГА: Не додавайте папку node_modules в систему контролю версій, у
          всіх розробників вона буде своя. Якщо ви використовуєте Git, не
          забувайте додати папку node_modules у файл .gitignore.
        </p>
        <p>
          Зверніть увагу на створений файл package-lock.json - це журнал знімків
          дерева залежностей проекту. Він гарантує, що команда розробників
          використовує однакові версії залежностей. NPM автоматично оновлює його
          під час додавання, видалення та оновлення пакетів.
        </p>
        <p>
          В package.json з'явилася нова залежність в полі dependencies. Це
          означає, що validator версії 11.1.0 був встановлений як залежність і
          готовий до роботи. Пакети постійно оновлюються, ваша версія може
          відрізнятися.
        </p>

        <h4>package.json</h4>
        <pre class="code">
{
  "dependencies": {
    "validator": "^11.1.0"
  }
}
</pre
        >
        <p>
          Щоб отримати інтерфейс пакета в Node.js-коді, необхідно викликати
          функцію require("ім'я-модуля"), передаючи аргументом їй ім'я модуля
          без визначення шляху - це називається абсолютний імпорт. Шлях не
          потрібен, оскільки за замовчуванням пошук модуля буде відбуватися в
          папці node_modules. Результатом свого виконання функція поверне
          інтерфейс модуля - об'єкт з методами або просто функцію - залежить від
          пакета.
        </p>
        <h4>index.js</h4>
        <pre class="code">
const validator = require("validator");

const validateEmail = email => {
  return validator.isEmail(email);
};

console.log(
  "Is mango@mail.com a valid email?: ",
  validateEmail("mango@mail.com")
);

console.log(
  "Is Mangozedog.com a valid email?: ",
  validateEmail("Mangozedog.com")
);
</pre
        >
        <p>Виконавши в терміналі npm start, отримаємо.</p>
        <pre class="code">
Is mango@mail.com a valid email?: true
Is Mangozedog.com a valid email?: false
</pre
        >
        <h3>Видалення пакетів</h3>
        <p>
          Припустимо, що версія validator, встановлена в попередньому прикладі,
          викликає проблеми з сумісністю. Ми можемо видалити цей пакет і
          поставити старішу версію.
        </p>
        <p class="code">npm uninstall validator</p>
        <h3>Встановлення певної версії пакета</h3>
        <p>
          Тепер встановимо потрібну версію validator. У команді встановлення
          номер версії вказується після символу @.
        </p>
        <p class="code">npm install validator@1.0.0</p>
        <p class="note">
          ЦІКАВО: Встановлення пакетів певної версії використовується в
          комерційних проектах для того, щоб гарантувати роботу кодової бази і
          можливість довгострокової підтримки. Ви можете встановлювати
          найостанніші версії.
        </p>
        <h3>Типи залежностей</h3>
        <p>
          Уявіть торт. Для його приготування шефу потрібні продукти, саме вони
          увійдуть до складу торта. Але для приготування потрібні будуть також
          інструменти на зразок мисок, ложок, лопаток тощо. А ще на кухні є
          столи і печі, холодильники тощо - те, що використовується для
          приготування будь-якої страви, загальні інструменти, які є на кухні.
        </p>
        <p>
          Те ж саме і з залежностями проекту - деякі будуть використані у
          фінальному продукті, інші необхідні тільки на стадії розробки, а є й
          такі, які необхідно використовувати, незалежно від проекту.
        </p>
        <p>
          Саме для цього команди npm install і npm uninstall мають три прапорці.
        </p>
        <ul class="section-list">
          <li>
            -save - вказує, що додається залежність, яка увійде до фінального
            продукту. Пакет буде встановлений локально, в папку node_modules і
            буде доданий запис в поле dependencies в package.json.
          </li>
          <li>
            -save-dev - вказує, що додається залежність розробки. Пакет буде
            встановлений локально в папку node_modules, і буде доданий запис в
            поле devDependencies в package.json.
          </li>
          <li>
            -global - вказує, що додається глобальна залежність, тобто
            інструмент, який доступний для будь-якого проекту. Пакет буде
            встановлений глобально (в систему).
          </li>
        </ul>
        <p class="note">
          ЦІКАВО: Якщо не вказувати прапорець, буде використаний --save за
          замовчуванням. Видаляючи пакет, необхідно вказувати правильний
          прапорець, такий самий, що й для встановлення. Не встановлюйте пакети
          глобально, якщо ви працюєте на проекті з іншими розробниками.
        </p>
        <h3>Управління версіями пакетів</h3>
        <p>
          Пакети мають пов'язаний з ними номер версії. Номери версій
          відповідають стандарту <a href="https://semver.org/">SemVer</a> .
        </p>
        <ul class="section-list">
          <li>
            npm outdated - використовується для пошуку оновлень, виявить сумісні
            версії програмно.
          </li>
          <li>
            npm update - оновить всі пакети до максимально дозволеної версії.
          </li>
          <li>npm update [ім'я-пакета] - оновить зазначений пакет.</li>
        </ul>
        <p class="note">
          ЦІКАВО: Якщо ви не довіряєте машинам або вам потрібна певна версія
          пакету, можна відкрити package.json і вручну поміняти версії пакетів,
          після чого виконати npm install.
        </p>
        <h3>Управління кешем</h3>
        <p>
          Після встановлення пакета npm зберігає його копію в кеші, тому під час
          наступного встановлення, вам не потрібно знову завантажувати його з
          інтернету. Кеш зберігається в папці .npm вашого домашнього каталогу.
        </p>
        <p>
          Ця папка з часом засмічується старими пакетами і її корисно іноді
          очищати, не дуже часто (декілька разів на рік). Кешування корисне,
          тому що скорочує час встановлення вже використаних пакетів.
        </p>
        <p class="code">npm cache clean </p>
      </section>
    </main>
    <footer class="footer">Це футер</footer>

    <script
      src="./pages/PagesLiveServer/JavaScript/js/main.js"
      type="module"
    ></script>
  </body>
</html>
